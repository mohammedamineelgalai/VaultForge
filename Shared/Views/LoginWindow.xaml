<Window x:Class="XnrgyEngineeringAutomationTools.Shared.Views.LoginWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{DynamicResource WindowTitleLogin}" 
        SizeToContent="Height"
        Width="500"
        MinWidth="480"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#1E1E2E"
        Loaded="Window_Loaded"
        Closing="Window_Closing">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/XnrgyStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Animation du Spinner -->
            <Storyboard x:Key="SpinnerAnimation">
                <DoubleAnimation Storyboard.TargetName="SpinnerRotation"
                               Storyboard.TargetProperty="Angle"
                               From="0" To="360" Duration="0:0:1"
                               RepeatBehavior="Forever"/>
            </Storyboard>
            
            <!-- Style bouton action XNRGY -->
            <Style x:Key="ActionButton" TargetType="Button">
                <Setter Property="Background" Value="#0078D4"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Padding" Value="20,12"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="border" Background="{TemplateBinding Background}" 
                                    CornerRadius="8" BorderBrush="#4A7FBF" BorderThickness="2"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="border" Property="Background" Value="#1E90FF"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#00D4FF"/>
                                    <Setter TargetName="border" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#00D4FF" BlurRadius="20" ShadowDepth="0" Opacity="0.7"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="border" Property="Background" Value="#555555"/>
                                    <Setter TargetName="border" Property="BorderBrush" Value="#444444"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Style TextBox moderne XNRGY -->
            <Style x:Key="ModernTextBox" TargetType="TextBox">
                <Setter Property="Padding" Value="10,0"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Background" Value="#12121C"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderBrush" Value="#4A7FBF"/>
                <Setter Property="BorderThickness" Value="2"/>
                <Setter Property="CaretBrush" Value="White"/>
                <Setter Property="Height" Value="40"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TextBox">
                            <Border x:Name="border" Background="{TemplateBinding Background}" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="6">
                                <Grid>
                                    <ScrollViewer x:Name="PART_ContentHost" 
                                                  Margin="10,0,10,0" 
                                                  VerticalAlignment="Center"
                                                  VerticalContentAlignment="Center"/>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsFocused" Value="True">
                                    <Setter TargetName="border" Property="BorderBrush" Value="#00D4FF"/>
                                    <Setter TargetName="border" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#00D4FF" BlurRadius="10" ShadowDepth="0" Opacity="0.4"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Style PasswordBox moderne XNRGY avec coins arrondis -->
            <Style x:Key="ModernPasswordBox" TargetType="PasswordBox">
                <Setter Property="Padding" Value="10,0"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="Background" Value="#12121C"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderBrush" Value="#4A7FBF"/>
                <Setter Property="BorderThickness" Value="2"/>
                <Setter Property="CaretBrush" Value="White"/>
                <Setter Property="Height" Value="40"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="PasswordBox">
                            <Border x:Name="border" Background="{TemplateBinding Background}" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="6">
                                <Grid>
                                    <ScrollViewer x:Name="PART_ContentHost" 
                                                  Margin="10,0,10,0" 
                                                  VerticalAlignment="Center"
                                                  VerticalContentAlignment="Center"/>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsFocused" Value="True">
                                    <Setter TargetName="border" Property="BorderBrush" Value="#00D4FF"/>
                                    <Setter TargetName="border" Property="Effect">
                                        <Setter.Value>
                                            <DropShadowEffect Color="#00D4FF" BlurRadius="10" ShadowDepth="0" Opacity="0.4"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header XNRGY Style -->
        <Border Grid.Row="0" Background="#2A4A6F" Padding="20,20">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Border Background="#0EA5E9" CornerRadius="12" Width="55" Height="55" Margin="0,0,15,0">
                    <TextBlock Text="🔐" FontFamily="Segoe UI Symbol" FontSize="28" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <StackPanel VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔐" FontFamily="Segoe UI Symbol" FontSize="22" Foreground="#FFD700" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="Connexion Vault" FontSize="22" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="Autodesk Vault Professional 2026" 
                               FontSize="12" Foreground="#B0B0B0" Margin="0,4,0,0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Formulaire de connexion -->
        <Border Grid.Row="1" Background="#12121C" Margin="20,20,20,10" Padding="25,20"
                CornerRadius="8" BorderBrush="#4A7FBF" BorderThickness="2">
            <StackPanel>
                <!-- Serveur -->
                <StackPanel Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="🖥" FontFamily="Segoe UI Symbol" FontSize="16" Margin="0,0,8,0" Foreground="#00BFFF"/>
                        <TextBlock Text="Serveur" Foreground="White" FontSize="14" FontWeight="Bold"/>
                    </StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="ServerTextBox" Grid.Column="0" Text="VAULTPOC" Style="{StaticResource ModernTextBox}"/>
                        <Button x:Name="BtnBrowseServer" Grid.Column="1" Content="..." 
                                Width="40" Height="40" Margin="8,0,0,0"
                                Style="{StaticResource ActionButton}" Background="#6366F1"
                                FontSize="16" FontWeight="Bold" Padding="0"
                                ToolTip="Rechercher les serveurs Vault sur le reseau"
                                Click="BtnBrowseServer_Click"/>
                    </Grid>
                </StackPanel>

                <!-- Vault -->
                <StackPanel Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="🗄" FontFamily="Segoe UI Symbol" FontSize="16" Margin="0,0,8,0" Foreground="#00BFFF"/>
                        <TextBlock Text="Vault" Foreground="White" FontSize="14" FontWeight="Bold"/>
                    </StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="VaultTextBox" Grid.Column="0" Text="PROD_XNGRY" Style="{StaticResource ModernTextBox}"/>
                        <Button x:Name="BtnBrowseVault" Grid.Column="1" Content="..." 
                                Width="40" Height="40" Margin="8,0,0,0"
                                Style="{StaticResource ActionButton}" Background="#6366F1"
                                FontSize="16" FontWeight="Bold" Padding="0"
                                ToolTip="Lister les Vaults disponibles sur le serveur"
                                Click="BtnBrowseVault_Click"/>
                    </Grid>
                </StackPanel>

                <!-- Utilisateur -->
                <StackPanel Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="👤" FontFamily="Segoe UI Symbol" FontSize="16" Margin="0,0,8,0" Foreground="#FFB74D"/>
                        <TextBlock Text="Utilisateur" Foreground="White" FontSize="14" FontWeight="Bold"/>
                    </StackPanel>
                    <TextBox x:Name="UserTextBox" Style="{StaticResource ModernTextBox}"/>
                </StackPanel>

                <!-- Mot de passe -->
                <StackPanel Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="🔑" FontFamily="Segoe UI Symbol" FontSize="16" Margin="0,0,8,0" Foreground="#FFD700"/>
                        <TextBlock Text="Mot de passe" Foreground="White" FontSize="14" FontWeight="Bold"/>
                    </StackPanel>
                    <PasswordBox x:Name="PasswordBox" Style="{StaticResource ModernPasswordBox}"/>
                </StackPanel>

                <!-- Sauvegarder -->
                <CheckBox Grid.Row="5" x:Name="SaveCredentialsCheckBox" 
                          Foreground="White" FontWeight="Bold" FontSize="13"
                          IsChecked="False" Margin="0,5,0,15">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="💾" FontFamily="Segoe UI Symbol" Margin="0,0,6,0" Foreground="#90EE90"/>
                        <TextBlock Text="Sauvegarder les identifiants" Foreground="White"/>
                    </StackPanel>
                </CheckBox>

                <!-- Spinner de connexion -->
                <Border x:Name="ConnectionSpinner" Visibility="Collapsed" 
                        Background="#2A4A6F" CornerRadius="6" Padding="15,10" Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Ellipse Width="22" Height="22" StrokeThickness="3" 
                                 Stroke="#00D4FF" StrokeDashArray="2,2" RenderTransformOrigin="0.5,0.5">
                            <Ellipse.RenderTransform>
                                <RotateTransform x:Name="SpinnerRotation" Angle="0"/>
                            </Ellipse.RenderTransform>
                        </Ellipse>
                        <TextBlock x:Name="ConnectionStatusText" Text="Connexion en cours..." 
                                   Foreground="#00D4FF" FontWeight="Bold" FontSize="13"
                                   Margin="12,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Message d'erreur -->
                <Border x:Name="ErrorBorder" Visibility="Collapsed"
                        Background="#3C1518" BorderBrush="#DC2626" BorderThickness="2" 
                        CornerRadius="6" Padding="15,10" Margin="0,0,0,15">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="❌" FontFamily="Segoe UI Symbol" FontSize="16" Foreground="#FF6B6B" Margin="0,0,10,0" VerticalAlignment="Center"/>
                        <TextBlock x:Name="ErrorMessage" Foreground="#FF6B6B" 
                                   FontWeight="Bold" FontSize="13"
                                   TextWrapping="Wrap" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Boutons -->
                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Button x:Name="ClearButton" Grid.Column="0"
                            Style="{StaticResource ActionButton}" Background="#6366F1"
                            Height="44" MinWidth="110" FontSize="13" FontWeight="Bold"
                            HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                            Click="ClearButton_Click"
                            ToolTip="Effacer les identifiants sauvegardes">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="🗑" FontFamily="Segoe UI Symbol" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Effacer" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="CancelButton" Grid.Column="2"
                            Style="{StaticResource ActionButton}" Background="#DC2626"
                            Height="44" MinWidth="110" FontSize="13" FontWeight="Bold"
                            HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                            Click="CancelButton_Click" Margin="0,0,10,0">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="✕" FontFamily="Segoe UI Symbol" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                            <TextBlock Text="Annuler" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="ConnectButton" Grid.Column="3"
                            Style="{StaticResource ActionButton}" Background="#10B981"
                            Height="44" MinWidth="150" FontSize="14" FontWeight="Bold"
                            HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
                            Click="ConnectButton_Click">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="➔" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="White"/>
                            <TextBlock Text="Connecter" Foreground="White" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Copyright Bar -->
        <Border Grid.Row="2" Style="{DynamicResource CopyrightBarBorder}">
            <Grid>
                <TextBlock Style="{DynamicResource CopyrightTextStyle}" HorizontalAlignment="Center"
                           Text="{DynamicResource CopyrightLogin}"/>
            </Grid>
        </Border>
    </Grid>
</Window>

